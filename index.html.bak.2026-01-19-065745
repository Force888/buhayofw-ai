<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BuhayOFW AI</title>
  <link rel="stylesheet" href="/ui.css">
</head>
<body>
  <div class="wrap">

    <div class="top">
      <div class="mascot">
        <div class="mascotFace"></div>
      </div>
      <div>
        <div class="title">BuhayOFW AI</div>
        <div class="subtitle">Tagalog-first AI assistant • simple, clear, and helpful</div>
      </div>
    </div>

    <div class="bubbles">
      <div class="bubble">Pwede Tagalog o English.</div>
      <div class="bubble">Health • Legal • Self-help</div>
      <div class="bubble warn">Not a doctor/lawyer — for guidance only.</div>
    </div>

    <div class="card">
      <label for="q" class="muted">Ask a question (Tagalog or English):</label>
      <textarea id="q" placeholder="Halimbawa: Ano ang dapat gawin kapag masakit ang binti habang naglalakad?"></textarea>

      <div class="row">
        <button id="send" class="btn">Send</button>
        <span id="status" class="muted"></span>
      </div>

      <div id="out" class="out"></div>
    </div>

    <div class="muted foot">
      Tip: Press Ctrl+Enter to send. Results may be imperfect—double-check important info.
    </div>

  </div>

<script>
  const q = document.getElementById('q');
  const statusEl = document.getElementById('status');
  const sendBtn = document.getElementById('send');

  function setStatus(t){ statusEl.textContent = t || ''; }

async function ask() {
  const text = q.value.trim();
  if (!text) return;

  // show user message as bubble
  addBubble('user', text);

  q.value = '';
  setStatus('Thinking...');
  sendBtn.disabled = true;

  try {
    const r = await fetch('/ask', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ question: text })
    });

    const data = await r.json();
    const answer =
      (data && (data.answer || data.text))
        ? (data.answer || data.text)
        : JSON.stringify(data, null, 2);

    // show AI response as bubble
    addBubble('ai', answer);
    setStatus('');
  } catch (e) {
    addBubble('ai', 'Error: ' + (e?.message || e));
    setStatus('');
  } finally {
    sendBtn.disabled = false;
    q.focus();
  }
}

  sendBtn.addEventListener('click', ask);
  q.addEventListener('keydown', (e) => {
    if(e.ctrlKey && e.key === 'Enter') ask();
  });
</script>

</body>
</html>
